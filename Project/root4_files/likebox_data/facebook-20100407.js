(function(){if(navigator.userAgent.match(/Firefox\/3/)||navigator.userAgent.match(/Namoroka\/3/)){var G=PicLensContext,c=function(bK){c.c=c.c||1;c.funcs=c.funcs||{};var bJ="f"+c.c;c.funcs[bJ]=bK;c.c+=1;return bJ;};var Z=function(){var bK=new G();this.version=bK.version;for(var bJ in bK){if(typeof bK[bJ]==="function"){this[bJ]=(function(bL){return function(){return bK[bL].apply(bK,arguments);};})(bJ);}}this.invoke=function(bO,bQ,bN){var bP=(typeof bO.getParentPropertyGroup!=="undefined"&&bQ=="addEventListener");if(bP){for(var bL in bN){if(typeof bN[bL]==="function"){bN[bL]=c(bN[bL]);}}}var bM=bK.invoke(bO,bQ,bN);if(bO==0&&bQ=="get"){var bL=bM[0];if(typeof bM[0]!="function"&&c.funcs[bM[0]]){bM[0]=c.funcs[bM[0]];}}return bM;};};PicLensContext=Z;}function a0(bJ){var bK=new function(){function bL(bN,bQ){var bP=this;for(var bO=0;bO<2;bO++){var bN=arguments[bO],bM=bN?bN.length:0;while(bM--){var bR=bN[bM];this[bR]=(function(bT,bS){return function(){var bW=arguments,bV=[],bU=bW.length;while(bU--){bV[bU]=bW[bU];}if(bS){bJ.invokeAsync(bP,bT,bV);}else{return bJ.invoke(bP,bT,bV);}};})(bR,bO);}}}this.buildStub=function(){return new bL(arguments);};this.buildStub2=function(bM,bN){return new bL(bM,bN);};};bJ.registerService("stubBuilder",bK);}function aV(bL){var bJ;var bT=1,bU={};function bR(bV){return Object.prototype.toString.apply(bV)==="[object Array]";}function bP(bV){return(typeof bV==="object"&&!bR(bV))||(typeof bV==="function");}function bN(bW){if(bR(bW)){var bV=bW.length;while(bV--){bW[bV]=bN(bW[bV]);}}else{if(bP(bW)){bO(bW);}}return bW;}function bK(bW){if(bR(bW)){var bV=bW.length;while(bV--){bW[bV]=bK(bW[bV]);}}else{if(bW&&bW.$ID){return bU[bW.$ID];}}return bW;}function bO(bV){if(bV.$ID){if(!bU[bV.$ID]){bU[bV.$ID]=bV;}bU[bV.$ID].$RC++;return bV.$ID;}bV.$RC=1;bU[bV.$ID=bT]=bV;return bT++;}function bM(bV,bW){return bO(bU[bV][bW]);}function bS(bV){o=bU[bV];if(o&&o.$ID&&!--o.$RC){delete bU[o.$ID];}}function bQ(bV,bX,bW){bV=bK(bV);bV.$RETVAL=bV.apply(bK(bX),bK(bW));}document.COOLIRIS={x:bQ,a:bO,r:bS,af:bM};return new function(){for(var bV in bL){if(typeof bL[bV]==="function"){this[bV]=(function(bW){return function(){return bL[bW].apply(bL,arguments);};})(bV);}}this.queryService=function(bW){var bX=bL.queryService(bW);return bX&&bU[bX];};this.registerService=function(bX,bW){bO(bW);bL.registerService(bX,bW);};this.invoke=function(bZ,b0,bY){var bX;bO(bZ);bY=bN(bY);try{bX=bL.invoke(bZ,b0,bY);}finally{var bW=bY.length;while(bW--){bS(bY[bW]&&bY[bW].$ID);}}if(bR(bX)){return bX[0];}else{return bX&&bU[bX];}};};}function av(){if(av.singleton){return av.singleton;}var bJ=null;if(typeof PicLensContext!="undefined"){bJ=new PicLensContext();if(navigator.userAgent.match(/Firefox\/2/)){bJ=aV(bJ);}}else{try{bJ=new ActiveXObject("PicLens.Context");}catch(bK){if(navigator.mimeTypes["application/x-cooliris"]){bJ=document.createElement("object");bJ.style.width="0px";bJ.style.height="0px";bJ.type="application/x-cooliris";document.documentElement.appendChild(bJ);}}}a0(bJ);return(av.singleton=bJ);}var ak=av();function a(bK,bJ){bJ(bK);bK=bK.firstChild;while(bK){a(bK,bJ);bK=bK.nextSibling;}}function by(bM,bL){if(!bM.className){return false;}var bK=bM.className.split(" ");var bJ=bK.length;while(bJ--){if(bK[bJ]===bL){return true;}}return false;}function bt(bM,bK){var bL=[],bJ=function(bN){if(by(bN,bK)){bL.push(bN);}};a(bM,bJ);return bL;}function bg(bN,bL,bK){var bO=bN.getElementsByTagName(bK),bJ=bO.length,bM=[];while(bJ--){if(by(bO[bJ],bL)){bM.push(bO[bJ]);}}return bM;}function x(bL,bK,bN){var bM=bL.getElementsByTagName(bK);var bJ=bM.length;while(bJ--){if(bM[bJ].id==bN){return bM[bJ];}}return null;}function J(bL,bM){var bK=[],bJ=function(bN){if(bN.id===bM||!bN.id&&bN.getAttribute&&bN.getAttribute("id")===bM){bK.push(bN);}};a(bL,bJ);return bK[0]?bK[0]:null;}var bC=/\<[^\>]*\>/g;var W=new (function(){var bJ=window;var bL=bJ.document;var bK=navigator.userAgent.toLowerCase();this.ie=!!bJ.VBArray;this.ie6=(this.ie&&bL.implementation);this.ie7=(this.ie&&bJ.XMLHttpRequest);this.gecko=(bJ.netscape&&!this.opera);this.safari=bK.indexOf("safari")+1;this.khtml=(this.safari||bK.indexOf("konqueror")+1);this.chrome=~bK.indexOf("chrome");});function a6(bM,bL){var bK=bM.getElementsByTagName(bL),bJ=bK.length;while(bJ--){bK[bJ].parentNode.removeChild(bK[bJ]);}}function F(bL){var bK=bL.getElementsByTagName("a"),bJ=bK.length;while(bJ--){bK[bJ].href=bK[bJ].href;}}function U(bK,bJ){if(!bJ){bJ=document.createElement("div");}if(W.ie){bJ.innerHTML="<div>"+bK;}else{bJ.innerHTML=bK;}return bJ;}function bp(bJ){var bK={x:0,y:0,width:bJ.offsetWidth,height:bJ.offsetHeight};while(bJ){bK.x+=bJ.offsetLeft;bK.y+=bJ.offsetTop;bJ=bJ.offsetParent;}return bK;}function T(){var bL=document.getElementsByTagName("head");if(bL.length){var bK=bL[0].getElementsByTagName("link");var bJ=bK.length;while(bJ-->0){var bM=bK[bJ];if(bM&&bM.rel&&(bM.rel.indexOf("icon")!=-1)&&bM.href){return bM.href;}}}return document.domain+"/favicon.ico";}function aD(){try{var bK=new DOMParser();this.parseFromString=function(bL){return bK.parseFromString(bL,"text/xml");};}catch(bJ){this.parseFromString=function(bM){try{var bL=new ActiveXObject("Microsoft.XMLDOM");bL.async="false";if(bL.loadXML(bM)){return bL;}else{return;}}catch(bN){}};}}function aL(){if(!aL.index){aL.index=0;}return"SlNBd2Vzb21lbmVzc0J5UEpKViZOVkU"+aL.index++;}function r(bK){if(!bK.applyCallback){var bJ=aL();bK.applyCallback="document."+bJ;(document[bJ]=function(bN,bL){var bM=bK[bN];delete bK.$returnValue;bK.$returnValue=bM&&bM.apply(bK,bL);}).toString=function(){};}}function a7(bL){if(bL.applyCallback){var bJ=bL.applyCallback.replace("document.","");try{delete document[bJ];}catch(bK){document[bJ]=undefined;}}}var A=window["eval"];function bB(bM,bO,bN){function bK(bQ){var bP=bQ.href,bR=bQ.getAttribute("href");if(bO&&bP&&bR!="#"&&bO(bP)){bQ.href=az+bP;}else{if(bQ.parentNode&&(bN||!bP||bR=="#")){var bS=document.createElement("span");bS.innerHTML=bQ.innerHTML;bQ.parentNode.replaceChild(bS,bQ);}}}if(bM){if(bM.tagName==="A"){bK(bM);}var bL=bM.getElementsByTagName("a"),bJ=bL.length;while(bJ--){bK(bL[bJ]);}}return bM;}function t(bN,bM){var bO=bp(bN),bK=bp(bM),bL=b(bO),bJ=bO.x-bK.x,bP=(bO.y-bK.y)+(bO.height-bL);return[bJ,bP,bL,bL];}function b(bP){var bN=36,bM=28,bL=35,bO=20,bJ=bP.height/2,bQ=bP.width/2,bK=bJ<bQ?bJ:bQ;if(bK<bL){bL=bK>bO?bK:bO;}return bL;}function aN(bJ){return encodeURIComponent(bJ||"");}function aw(bJ){return decodeURIComponent(bJ?bJ.replace(/\+/g,"%20"):"");}function y(bK){bK=bK||location.search;bK=bK.replace("?","");var bN={},bO=bK.split("&"),bL=0,bM=bO.length;for(;bL<bM;bL++){var bJ=bO[bL].split("=");if(bJ.length===2){bN[aw(bJ[0])]=aw(bJ[1]);}else{if(bJ.length===1){bN[aw(bJ[0])]="";}}}return bN;}function ba(bK){var bL="";for(var bJ in bK){if(bK.hasOwnProperty(bJ)&&bJ){bL+=(bL?"&":"?")+aN(bJ)+"="+aN(""+bK[bJ]);}}return bL;}function a5(bJ){bJ=bJ||"";bJ+="";return bJ.replace(/\&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\'/g,"&apos;").replace(/\"/g,"&quot;");}function g(bJ){bJ=bJ||"";bJ+="";return bJ.replace(/&quot;/g,'"').replace(/&apos;/g,"'").replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&amp;/g,"&");}function p(bK){if(bK){var bL=document.createElement("div");if(bK.parentNode){bL.appendChild(bK.cloneNode(true));return bL.innerHTML;}else{bL.appendChild(bK);var bJ=bL.innerHTML;bL.removeChild(bK);return bJ;}}return"";}var l="http://www.w3.org/1999/xhtml";function z(bJ){return bJ&&bJ.replace(/^<(\w+)\s*(.*?)/,'<$1 xmlns="'+l+'" $2');}var bE=/(&(quot|amp|gt|lt);)|(&(\w+);)/g;var D="$1";var ap=/<([^"<>]+?)=(\w+)([^"<>]*?)\>/g;var S='<$1="$2"$3>';var L=/(<.*?\s+class=)([^\s>]+)(\s|>)/g;var X='$1"$2"$3';var an=/(<.*?\s+id=)([^\s>]+)(\s|>)/g;var bG='$1"$2"$3';var bI=/\<!--.*?--\>/ig;function bs(bJ){if(W.ie){return z(p(bJ).replace(bI,"").replace(/<br>/ig,"<br/>").replace(bE,D).replace(L,X).replace(an,bG).replace(/<\/?\s*(\S+)\s*/g,function(bK){return bK.toLowerCase();}));}else{return z(p(bJ).replace(bI,"").replace(/<br>/ig,"<br/>").replace(bE,D).replace(ap,S));}}function aF(bJ){var bK=bJ.xml||(new XMLSerializer()).serializeToString(bJ);return z(bK);}var be={a:true,p:true,br:true,span:true,b:true,i:true,u:true};var bw=/<\/?(\w+)(\s[^>]*)?>/g;function bF(bJ){if(be[bJ]){return true;}else{return false;}}function aU(bK){if(!bK){return;}var bJ=function(bM,bL){if(bF(bL)){return bM;}else{return"";}};return bK.replace(bw,bJ);}var bi={tr:"p",li:"p",dt:"p",dd:"p",h1:"p",h2:"p",h3:"p",h4:"p",h5:"p",h6:"p",strong:"b",div:"p"};var ar={th:" ",td:" ",hr:z("<br/>")};var bb=/<(\/)?(\w+)(\s[^>]*)?>/g;function af(bK){if(!bK){return;}var bJ=function(bQ,bN,bM,bL){if(bi[bM]){var bP=bN?bN:"";var bO=bL?bL:"";return"<"+bP+bi[bM]+bO+">";}else{if(ar[bM]){return ar[bM];}else{return bQ;}}};return bK.replace(bb,bJ);}function C(bM){var bN=new aD();var bL=bN.parseFromString(bM);if(bL){return bM;}var bK=function(bP,bO){if(bO=="br/"){return bP;}else{return"";}};var bJ='<span xmlns="'+l+'">'+bM.replace(/<\/?p[^>]*>/g,"<br/>").replace(/<([^>]*)>/g,bK)+"</span>";bL=bN.parseFromString(bJ);if(bL){return bJ;}return"";}function aj(bJ){return Object.prototype.toString.apply(bJ)==="[object Array]";}function M(bJ,bK){bJ.constructor.prototype[bK].call(bJ);}function at(bM,bK){var bL={},bJ=true;if(typeof bM==="object"){for(var bN in bM){bL[bN]=1;if(typeof bM[bN]==="object"){bJ=bJ&&at(bM[bN],bK[bN]||{});}else{bJ=bJ&&(bM[bN]===bK[bN]);}}for(var bN in bK){if(!bL[bN]){bJ=false;}}}else{bJ=(bM===bK);}return bJ;}function bl(bL,bK){bK=bK||(aj(bL)?[]:{});for(var bJ in bL){if(typeof bL[bJ]==="object"){bK[bJ]=bl(bL[bJ]);}bK[bJ]=bL[bJ];}return bK;}function aq(bL,bK){if(!bL||!bK){return bL;}for(var bJ in bK){bL[bJ]=bK[bJ];}return bL;}function aQ(bL,bK){if(!bK||!bL){return bK;}for(var bJ in bK){if(!bL.hasOwnProperty(bK[bJ])){bL[bJ]=bK[bJ];}}return bL;}function aC(bM,bL){var bJ={};for(var bK=0;bK<bL.length;bK++){if(bM.hasOwnProperty(bL[bK])){bJ[bL[bK]]=bM[bL[bK]];}}return bJ;}function aY(bL,bJ){var bK;if(bL.attributes){bK=bL.attributes[bJ];return bK&&bK.nodeValue;}else{return bL.getAttribute(bJ);}}function ac(bK,bJ){return window.setTimeout(bK,bJ);}function H(bK,bJ){return window.setInterval(bK,bJ);}function br(bL,bJ){var bK=O(bL,bJ);return bK&&bK.href;}function O(bN,bJ){var bM=bN.atom$link||bN.link,bO=aj(bM)?bM:[bM],bK=bO.length,bL;while(bL=bO[--bK]){if(bL.rel===bJ){return bL;}}return null;}var s="http://www.w3.org/2005/Atom";function bv(bK,bJ){return{xmlns:s,rel:bJ||"",href:bK};}function aE(){var bL=ak.queryService("experiments"),bO=bL.getExperimentValue("xslt-cache-buster");if(bO){return bO;}else{var bK=document.getElementsByTagName("head");if(bK.length){var bN=bK[0].getElementsByTagName("script"),bM=bN.length;while(--bM){var bP=bN[bM],bJ=bP.src&&bP.src.match(/js\.cooliris\.com\/.+\/feeds\/.+-?(.*)?\.js\?(\d+)/);if(bJ){return bJ[1]||bJ[2];}}}}return(new Date()).getTime();}function aO(bJ){return bv(bJ+"?"+aE(),"stylesheet");}var a9="http://schemas.google.com/g/2005";function bH(bJ,bK){return{xmlns:a9,name:bJ,value:bK};}var m=/(https?:\/\/([.]|[^\s])*)[\s$]?/;function bj(bJ){bJ=bJ||"";return bJ.replace("\r\n","<html:br />").replace("\n","<html:br />").replace(m,'<html:a href="$1">$1</a>');}function bd(bK,bJ){bK=String(bK);bJ=bJ||2;while(bK.length<bJ){bK="0"+bK;}return bK;}function bx(bJ){var bN=parseInt(bJ,10);var bL=bN%60;var bM=Math.floor(bN/60)%60;var bK=Math.floor(bN/3600);time=bd(bM)+":"+bd(bL);if(bK){time=bd(bK)+":"+time;}return time;}function aG(bJ){return bJ.replace("$",":");}function k(bM){var bK="";for(var bJ in bM){var bL=bM[bJ];if(bJ.indexOf("xmlns$")===0){bK+=" "+aG(bJ)+'="'+a5(bL)+'"';}}return bK;}function bu(bJ,bL,bO){var bN=false,bR=aG(bJ),bS="<"+bR;for(var bP in bL){var bQ=bL[bP];if(typeof bQ!="object"){if(bP=="$t"||bP=="$xml"){bN=true;}else{bS+=" "+aG(bP)+'="'+a5(bQ)+'"';}}else{bN=true;}}if(bO){bS+=bO;}if(bN){bS+=">";for(var bP in bL){var bQ=bL[bP];if(typeof bQ==="object"){var bK=bQ.length;if(typeof bK!=="undefined"){for(var bM=0;bM<bK;bM++){bS+=bu(bP,bQ[bM]);}}else{bS+=bu(bP,bQ);}}else{if(bP=="$t"){bS+=a5(bQ);}else{if(bP=="$xml"){bS+=bQ;}}}}bS+="</"+bR+">";}else{bS+=" />";}return bS;}function h(bJ,bL,bK){return bu(bJ,bL,bK);}var az="jsfeed:",u,aB=(function(){var bL=/(((\w+:?)\/\/)([^\/:]*)(:(\d*))?)?([^#?]*)(\?([^#]*))?(#!?([^?]*)(\?(.*))?)?/,bJ=/^jsfeed:/i;u=function(bM){return bM.replace(bJ,"");};var bK=function(bN,bM){this.parseURI(bN||location.href,bM);};bK.prototype.parseURI=function(bO,bM){if(bO instanceof bK){return bl(bO,this);}var bN=u(bO).match(bL);this.hash=bN[10];this.host=bN[4];this.hostname=bN[4];this.protocol=bN[3];this.href=bN[0];if(bM){this.pathname=(bN[11]||bN[7])||"";this.search=(bN[12]||bN[8])||"";this.hash="";}else{this.pathname=bN[7];this.search=bN[8];}this.queryParameters=y(this.search||"?");return this;};bK.prototype.implodeQueryString=function(){this.search=ba(this.queryParameters);return this.search;};bK.prototype.toString=function(){var bM="";this.protocol&&(bM+=this.protocol+"//");this.host&&(bM+=this.host);this.port&&(bM+=":"+this.port);if(this.host&&!this.pathname){bM+="/";}this.pathname&&(bM+=this.pathname);this.implodeQueryString();this.search&&(bM+=this.search);this.hash&&(bM+=this.hash);return bM;};bK.prototype.toStringWithFragment=function(){return this.toString()+(this.hash||"");};bK.prototype.equals=function(bM){return this.protocol===bM.protocol&&this.host===bM.host&&this.hostname===bM.hostname&&this.port===bM.port&&this.pathname===bM.pathname&&(this.search===bM.search||at(this.queryParameters,bM.queryParameters))&&(this.hash===bM.hash||at(y(this.hash.replace("#","")),y(bM.hash.replace("#",""))));};return bK;})();function ah(bK,bJ){this.status=bK.status;this.statusText=bK.statusText;this.responseXML=bK.responseXML;this.responseText=bK.responseText;this.responseBody=bK.responseBody;this.responseStream=bK.responseStream;this.readyState=bK.readyState;this.uri=bJ;this.request=bK;return this;}function j(bJ,bL){var bK;if(window.XMLHttpRequest){bK=new XMLHttpRequest();}else{if(window.ActiveXObject){bK=new ActiveXObject("Microsoft.XMLHTTP");}}if(bK){bK.open("GET",u(bJ),true);bK.onreadystatechange=function(){if(bK.readyState===4){bL(new ah(bK,bJ));}};bK.send(null);}}function i(bK,bJ){if(bK&&typeof bJ==="undefined"){if(typeof bK.begin!=="undefined"){this.begin=bK.begin;this.end=bK.end;}else{this.begin=bK[0];this.end=bK[1];}}else{this.begin=bK||0;this.end=bJ||0;}if(this.begin>this.end){this.begin=this.end=0;}return this;}i.prototype={contains:function(bJ){return(bJ.begin>=this.begin&&bJ.end<=this.end);},intersect:function(bK){var bL=bK.begin>this.begin?bK.begin:this.begin;var bJ=bK.end<this.end?bK.end:this.end;return(bJ>=bL)?new i(bL,bJ):new i();},union:function(bJ){var bK=new i(bJ.begin<this.begin?bJ.begin:this.begin,bJ.end>this.end?bJ.end:this.end);return(bK.end>=bK.begin)?bK:new i();},empty:function(bJ){return this.begin==this.end;},size:function(){return this.end-this.begin;},toString:function(){return"["+this.begin+","+this.end+")";}};i.empty=new i(0,0);var ag=0,n=80,ai=16;if(W.ie){ag=50;}var aS=new function(){var bK=[],bP=0,bO;function bL(){return(new Date).getTime();}function bN(){if(bK.length){bO=bL()+ag;setTimeout(bJ,ag);}}function bM(bQ){if(bQ<=0){return ai;}else{return Math.min(n,ai+bQ);}}function bJ(){var bS=bL(),bV=bS-bO,bU=bM(bV),bR;++bP;var bQ=bL(),bT=0;while((bL()-bS<bU)&&(bR=bK.shift())){try{bR();}catch(bW){}bT++;}--bP;bN(bS);}this.run=function(bQ){bK.push(bQ);if(bP==0){bO=bL();bJ();}};};var ab=(function(){var bJ=0;return function(){return"e"+ ++bJ;};})(),f=ab(),w=ab();function aA(){if(!aA.instance){this.events={};aA.instance=this;}return aA.instance;}function aK(){return aA.instance||new aA();}aA.prototype.addListener=function(bJ,bL){var bK=this.events[bJ]||(this.events[bJ]=[]);bK.unshift(bL);};aA.prototype.removeListener=function(bJ,bM){var bL=this.events[bJ],bK=bL.length;while(bK--){var bN=bL[bK];if(bN===bM){bL.splice(bK,1);return;}}};aA.prototype.fire=function(bK,bJ){var bM=this.events[bK]||[],bL=bM.length;if(bJ!==undefined&&!aj(bJ)){bJ=[bJ];}while(bL--){if(typeof bM[bL]==="function"){bM[bL].apply(null,bJ||[]);}}};function aJ(){}aJ.prototype.initialize=function(){this.eventListeners={};this.weblink=location.href;this.uri;this.rangeBounds=new i(-65536,65535);this.rangeLoaded=new i;this.rangeNeeded=new i;this.ITEMS_PER_REQUEST=NaN;return this;};var aX=unescape("%20%BB%20");aJ.prototype.dispose=function(){aK().fire(w);};aJ.prototype.loadRange=function(bJ){};aJ.prototype.addItem=function(bJ,bK){this.addItems([bJ],bK);};aJ.prototype.addItems=function(bL,bJ){var bK;if(bJ){bK=new i(this.rangeLoaded.begin-bL.length,this.rangeLoaded.begin);}else{bK=new i(this.rangeLoaded.end,this.rangeLoaded.end+bL.length);}this.rangeLoaded=this.rangeLoaded.union(bK);this.rangeBounds.end=Math.round(this.rangeBounds.end);this.raiseRangeLoadedEvent({range:bK,bounds:this.rangeBounds,items:bL});};aJ.prototype.raiseEvent=function(bK,bJ){try{var bL=this.eventListeners[bK];if(bL){bL(bJ);}}catch(bM){}};aJ.prototype.raiseRangeLoadedEvent=function(bL){var bK={begin:{$t:""+bL.range.begin},end:{$t:""+bL.range.end}},bO={begin:{$t:""+bL.bounds.begin},end:{$t:""+bL.bounds.end}},bJ=bL.items,bN=(((bJ[0]&&bJ[0].feedUrl)&&("<feedUrl>"+a5(bJ[0].feedUrl)+"</feedUrl>"))||""),bP="<range>"+bN+bu("range",bK)+bu("rangeBounds",bO);for(var bM=0;bJ&&bM<bJ.length;bM++){bP+=bJ[bM].xml;}bP+="</range>";if(this.eventListeners.rangeLoaded2){this.raiseEvent("rangeLoaded2",bP);}else{this.raiseEvent("rangeLoaded",bL);}};aJ.prototype.parseComplete=function(){};aJ.prototype.parseResponseWithContinuation=function(bJ){var bM=this,bN=[],bL=false,bO=function(){if(bJ.EOF){if(bL){bM.rangeBounds.begin=bM.rangeLoaded.begin;}else{bM.rangeBounds.end=bM.rangeLoaded.end;}bM.setBounds();}bM.parseComplete();},bP=function(){return bJ.moveNext();},bK=function(){bO();},bR=function(bS){bM.addItem(bS,bL);};if(this.rangeToLoad.begin<0){bL=true;if(bJ.movePrev){bJ.moveLast();bP=function(){return bJ.movePrev();};}else{bR=function(bS){bN.push(bS);};bK=function(){bM.addItems(bN,bL);bO();};}}function bQ(){try{if(bP()){bR(bJ.current);aS.run(bQ);}else{bK();}}catch(bS){bM.setBounds(bM.rangeLoaded);bM.parseComplete();}}aS.run(bQ);};aJ.prototype.setBounds=function(bJ){bJ&&(this.rangeBounds=bJ);this.raiseRangeLoadedEvent({range:i.empty,items:[],bounds:this.rangeBounds});};aJ.prototype.addEventListener=function(bJ,bK){this.eventListeners[bJ]=bK;};aJ.prototype.noResultsLoaded=function(){this.setBounds(i.empty);};aJ.prototype.setPropertyGroup=function(bJ){this.propertyGroup=bJ;if(bJ){var bK=this;bJ.addEventListener(function(){bK.propertyChanged.apply(bK,arguments);});bJ.setCallMethodDelegate(this);}this.propertyGroupConnected();};aJ.prototype.propertyGroupConnected=function(){};aJ.prototype.propertyChanged=function(bJ,bK,bL,bM){};var a8=false,ax=true,aT="http://js.cooliris.com/",E=aO(aT+"layout/facebook.xslt"),am=aT+"static/images/site.facebook.png",aM="Facebook",aP="http://www.facebook.com/",au="jsfeed:"+aP+"home.php",ao=aT+"static/images/facebook.big.logo.jpg",a2=/(\d*)\/[anst](\d*_)/,a1=/(.*?_)[anst](\.\w+)/,al="$1/a$2",ae="$1/n$2",d=location.protocol+"//"+location.host,bo=/.*?\/[anst](\d*)_(\d*)_(.*)/,bn=/.*?_(\d*)_(\d*)_\d*_?[anst]?\..*/,I='<?xml version="1.0" encoding="UTF-8"?><ci:feedData xmlns:ci="http://schemas.cooliris.com/layout/2008"><ci:navbar-link>'+au+"</ci:navbar-link> <ci:hide-favorite-feed>true</ci:hide-favorite-feed></ci:feedData>";function a4(bJ){if(bJ.match(a2)){return bJ.replace(a2,"$1/a$2");}else{return bJ.replace(a1,"$1a$2");}}function ad(bJ){if(bJ.match(a2)){return bJ.replace(a2,"$1/n$2");}else{return bJ.replace(a1,"$1n$2");}}function aI(bK){var bJ;if(bJ=bK.match(bo)){return bJ[1];}else{return bK.replace(bn,"$1");}}function bD(bK){var bJ;if(bJ=bK.match(bo)){return bJ[2];}else{return bK.replace(bn,"$2");}}function a3(){return{xmlns$atom:s,atom$link:{rel:"pivot",href:au},atom$logo:{$t:am}};}function bh(bJ){this.parseURI(bJ||location.href,true);}bh.prototype=new aB();bh.prototype.canonicalID=function(){var bJ=aC(this.queryParameters,["id","pid"]);return ba(bJ)||" ";};function e(bK,bM,bL){if(bM&&(bM.isSessionOk&&!bM.isSessionOk(bK))){var bO='<span>In order to access all of your Facebook photos in Cooliris, please <a href="'+aP+'">login</a> and try again.</span>',bJ='<span><a href="'+aP+'">Sorry, you have been logged out of Facebook.</a></span>',bN={guid:{$t:aP},feedUrl:{$t:aP},contextinfo:{$xml:z(bO)},media$description:{$xml:z(bJ)},link:[{$t:aP},E],media$thumbnail:{url:ao},media$content:{url:ao},atom$source:a3()};bN=P(bN);bM.addItem(bN);bM.parseComplete();}else{bL(bK);}}function aR(bJ,bK){return function(bL){e(bL,bK,bJ);};}var ay=function(){var bK=arguments,bJ=(function(){if(!bK[6]&&typeof AsyncRequest==="function"){return function(bS,bO,bP,bM,bQ,bR,bN){var bL=(new AsyncRequest);bL.setURI(bS).setReadOnly(true).setMethod("GET").setOption("suppressEvaluation",bR).setData(bO).setHandler(aR(bP,bQ)).setErrorHandler(aR(bM,bQ)).setTransportErrorHandler(aR(bM,bQ));bL.send();};}else{return function(bT,bQ,bS,bO,bR,bP,bN){var bM,bL=new aB();bL.pathname=bT;bL.queryParameters=bQ;bL.hash="";bL=bL.toString();bM=function(bU){bU.getPayload=function(){if(!bU.fbData){var bW=bU.responseText;if(bW.indexOf("for")===0){bW=bW.substring(9);}try{if(!bP){bU.fbData=A("("+bW+")");aq(bU,bU.fbData);}}catch(bV){}}return bP?bU:bU.payload;};aR(bS,bR)(bU);};j(bL,bM);};}})();bJ.apply(null,arguments);};aJ.prototype.setBounds=function(bK){bK&&(this.rangeBounds=bK);if(bK&&bK.empty()){this.raiseRangeLoadedEvent({range:i.empty,items:[],bounds:this.rangeBounds});return;}else{var bJ=this,bL={};bL.__a=this.pageState.__a;bL.reason="3";bL.iframe_loaded="true";ay("/ajax/presence/reconnect.php",bL,function(bM){},function(bM){},this);}};function bk(bJ,bK){ay(bK,bJ.pageState,function(bL){bJ.asyncResponse(bL);},function(bL){bJ.asyncResponseError(bL);},bJ);}function R(bN,bK,bL,bJ,bM){ay(bN,bK,bL,bJ,bM,true,true);}function Y(bK){var bL=new bh(bK);var bJ=bL.pathname;return(bf.feedUriForUri(bL)&&(bL.pathname==bJ));}ac=function(bK,bJ){if(window.setTimeout_native){return window.setTimeout_native(bK,bJ);}else{return window.setTimeout(bK,bJ);}};H=function(bK,bJ){if(window.setInterval_native){return window.setInterval_native(bK,bJ);}else{return window.setInterval(bK,bJ);}};var q=["load","DOMNodeInserted"],bc,bz="on";function B(bL,bK,bJ){bK=bK||document;bJ=bJ||q;if(bK.addEventListener){bc=bJ.length;while(bc--){bK.addEventListener(bJ[bc],bL,true);}}else{if(bK.attachEvent){bc=bJ.length;while(bc--){bK.attachEvent(bz+bJ[bc],bL);}}}}function aZ(bL,bK,bJ){bK=bK||document;bJ=bJ||q;if(bK.addEventListener){bc=bJ.length;while(bc--){bK.removeEventListener(bJ[bc],bL,true);}}else{if(bK.attachEvent){bc=bJ.length;while(bc--){bK.detachEvent(bz+bJ[bc],bL);}}}}function Q(){}Q.prototype.initialize=function(){var bK=this,bJ=function(){bK.reScan();};B(bJ);this.eventListeners=[];};Q.prototype.register=function(){ak.registerService("pageHandler",this);this.raiseEvent("launchableChanged",this.canLaunch);};Q.prototype.raiseEvent=function(bK,bJ){aK().fire(bK,bJ);};Q.prototype.addEventListener=function(bJ,bK){aK().addListener(bJ,bK);};Q.prototype.dispose=function(){};Q.prototype.feedForUrl=function(bJ){};Q.prototype.parseContentFromDOM=function(){};Q.prototype.reScan=function(){var bK=this,bJ=function(){bK.domScannerTimer=null;bK.parseContentFromDOM();var bL=bK.canLaunch;bK.canLaunch=(!!bK.feedForUrl());if(bK.canLaunch!=bL){bK.raiseEvent("launchableChanged",bK.canLaunch);}};if(!this.domScannerTimer){this.domScannerTimer=ac(bJ,250);}};Q.prototype.contentItemHandlerForUrl=function(bJ){return this.propertyGroupHandlerForUrl(bJ);};Q.prototype.propertyGroupHandlerForUrl=function(bJ){};Q.prototype.canLaunch=function(){return !!this.elements.length;};function V(){}V.prototype=new aJ();V.prototype.parseResponse=function(bK,bJ){this.parseComplete();};V.prototype.parseComplete=function(){var bJ=this;aS.run(function(){bJ.loadContinuation();});};V.prototype.asyncResponse=function(bJ){this.parseResponse(bJ);};V.prototype.asyncResponseError=function(bJ){this.noResultsLoaded();};V.prototype.loadContinuation=function(){var bK=this.rangeNeeded.intersect(this.rangeBounds);var bL=this.rangeLoaded.begin-bK.begin;var bJ=bK.end-this.rangeLoaded.end;if(bJ>=bL&&bJ>0){bK.begin=this.rangeLoaded.end;bK.end=Math.min(this.rangeLoaded.end+this.ITEMS_PER_REQUEST,this.rangeBounds.end);}else{if(bL>bJ&&bL>0){bK.begin=Math.max(this.rangeLoaded.begin-this.ITEMS_PER_REQUEST,this.rangeBounds.begin);bK.end=this.rangeLoaded.begin;}else{bK.begin=0;bK.end=0;}}if(bK.empty()){this.loading=false;return;}this.rangeToLoad=bK;this.makeAsyncRequest(bK);};V.prototype.startLoading=function(){this.loadContinuation();};V.prototype.makeAsyncRequest=function(bJ){};V.prototype.loadRange=function(bJ){if(this.rangeLoaded.empty()){aK().fire(f);}bJ=new i(bJ);bJ=this.rangeBounds.intersect(bJ);if(this.rangeLoaded.contains(bJ)||this.rangeNeeded.contains(bJ)){return;}this.rangeNeeded=bJ;if(!this.loading){this.loading=true;this.startLoading();}};function aH(){}function P(bL,bK){if(bK){bK=" "+bK;}else{bK=' xmlns:media="http://search.yahoo.com/mrss/"';}var bJ={xml:h("item",bL,bK)};if(bL.feedUrl){bJ.feedUrl=bL.feedUrl.$t;}return bJ;}function bq(bJ,bL){var bM=[];for(var bK=0;bK<bJ.length;bK++){bM.push(P(bJ[bK],bL));}return bM;}function N(bJ){this.initialize();this.logo=am;this.title=aM;this.feedData=I;this.ITEMS_PER_REQUEST=20;this.parsedUri=bJ;this.uri=bJ.toString();}N.prototype=new V();N.prototype.startLoading=function(){if(this.parsedUri.pathname=="/photo.php"){if(this.parsedUri.currentPage){this.initializePageState(document);}else{var bJ=this;R("/photo.php",bJ.parsedUri.queryParameters,function(bK){var bL=bK.htmlDocument||U(bK.getPayload().responseText);bJ.initializePageState(bL);bJ.loadContinuation();},function(bK){bJ.asyncResponseError(bK);},this);return;}}else{this.initializePageState();}this.loadContinuation();};N.prototype.initializePageState=function(bP){try{if(bP){var bQ=bg(bP,"single_photo_header","div")[0],bM=bQ.getElementsByTagName("a"),bK=bM.length,bL,bJ;while(bK--){if(!(bJ=bM[bK].href)){continue;}bL=new bh(bJ);switch(bL.pathname){case"/photo_search.php":case"/album.php":this.albumUri=bL;break;}}}else{this.albumUri=this.parsedUri;}var bO={async:true};if(this.albumUri.pathname=="/photo_search.php"){bO.view="global";this.albumUri.queryParameters.page=Math.floor(((this.albumUri.queryParameters.page||1)-1)*15/this.ITEMS_PER_REQUEST)+1;}this.pageState=aq(bO,this.albumUri.queryParameters);this.pageState.page=(+this.pageState.page||1);this.rangeBounds.begin=-(this.pageState.page-1)*this.ITEMS_PER_REQUEST;}catch(bN){this.noResultsLoaded();}};N.prototype.makeAsyncRequest=function(bJ){this.pageState.page=Math.round(1+(bJ.begin-this.rangeBounds.begin)/this.ITEMS_PER_REQUEST);bk(this,this.albumUri.pathname);};function K(bR,bL){var bJ=bL.getPayload().data,bQ=0,bO=0,bP=new bh(bR.albumUri);bP.queryParameters.page=bR.pageState.page;var bM=bP.toString();var bN=this;function bK(bX){bO++;var bW=bJ[bQ];bQ+=bX;if(!bW){delete bN.current;bN.EOF=(bJ.length<20);return false;}var bU="?id="+bW.id+"&pid="+bW.pid;var bT=d+"/photo.php"+bU;var bS=document.createElement("span"),b0=document.createElement("span");bS.innerHTML=bW.context_info;a6(bS,"br");bB(bS,Y,ax);b0.innerHTML=bW.tags.replace(/\s*\|(.*?)\)/g,")").replace(/(\(.*?href="#".*?\))/g,"");a6(b0,"script");bB(b0,Y,ax);var bZ=[],b1,bV=0;while(b1=bW.photo_tags[bV++]){bZ.push({x:b1[0],y:b1[1],name:b1[2].replace(bC,""),id:b1[3]});}var bY={guid:{$t:bU},feedUrl:{$t:bM},media$description:{$t:bW.caption_plaintext},link:[{$t:bT},E],media$thumbnail:{url:a4(bW.src)},media$content:{url:ad(bW.src)},contextinfo:{$xml:bs(bS)},tags:{$xml:bs(b0)},tagmetadata:bZ,atom$source:a3()};bN.current=P(bY);return true;}this.moveNext=function(){return bK(1);};this.movePrev=function(){return bK(-1);};this.moveLast=function(){bQ=bJ.length-1;};}N.prototype.parseResponse=function(bJ){this.parseResponseWithContinuation(new K(this,bJ));};N.prototype.isSessionOk=function(bJ){var bL=bJ.getPayload(),bK;if(bL.responseText){bK=U(bL.responseText);bJ.htmlDocument=bK;return !J(bK,"loginform");}else{return !(bJ.error===1357001);}return true;};function bA(bJ){this.initialize();this.logo=am;this.feedData=I;this.title=aM;this.ITEMS_PER_REQUEST=20;this.uri=bJ.toString();this.parsedUri=bJ;this.pageState=aq({view:"recent"},this.parsedUri.queryParameters);this.pageState.s=this.pageState.s?+this.pageState.s:0;this.rangeBounds.begin=-this.pageState.s;}bA.prototype=new V;bA.prototype.makeAsyncRequest=function(bJ){this.pageState.s=bJ.begin-this.rangeBounds.begin;this.pageState.__a=1;this.pageState.key="albums";this.pageState.sk="albums";bk(this,"/ajax/home/media.php");};function aa(bQ,bK){var bP=U(bK.getPayload().html),bS=bP.getElementsByTagName("tr"),bR=0,bM=this,bN=0,bO=new bh(bQ.parsedUri);bO.queryParameters.s=bQ.pageState.s;var bL=bO.toString();function bJ(){var bV=bS[bR++];if(!bV){delete bM.current;if(bN<bQ.ITEMS_PER_REQUEST){bM.EOF=true;}return false;}var bW=bV.getElementsByTagName("td"),bU=bW;col=0;function bT(){var bY=bW[col++];if(!bY){return bJ();}bB(bY,Y,ax);var b4=bY.getElementsByTagName("a")[0],b3=b4.href,bX=document.createElement("div"),b1=bY.getElementsByTagName("a")[1],b0=bY.getElementsByTagName("i")[0].style.backgroundImage,bZ=b0.replace(/url\("?(.*?)"?\)/,"$1");bX.innerHTML="<a href='"+b4.href+"' >"+b4.title+"</a>";var b2={guid:{$t:b3},feedUrl:{$t:bL},link:[{$t:b3},E],media$thumbnail:{url:a4(bZ)},media$content:{url:ad(bZ)},album:{$xml:bs(bX)},author:{$xml:bs(b1)},atom$source:a3()};bM.current=P(b2);bM.moveNext=bT;bN++;return true;}return bT();}bM.moveNext=bJ;}aa.prototype.xmlDOMParser=new aD();bA.prototype.parseResponse=function(bJ){this.parseResponseWithContinuation(new aa(this,bJ));};bA.prototype.isSessionOk=function(bJ){return !!bJ.getPayload().html;};function aW(bJ){this.initialize();this.logo=am;this.title=aM;this.feedData=I;this.ITEMS_PER_REQUEST=20;this.uri=this.albumUri=bJ.toString();this.parsedUri=bJ;this.pageState={id:bJ.queryParameters.id,view:"global",page:bJ.queryParameters.page,v:"photos",async:"true"};this.pageState.page=(+this.pageState.page||1);this.rangeBounds.begin=-(this.pageState.page-1)*this.ITEMS_PER_REQUEST;}aW.prototype=new V;aW.prototype.makeAsyncRequest=function(bO){this.pageState.page=Math.round(1+(bO.begin-this.rangeBounds.begin)/this.ITEMS_PER_REQUEST);var bN=this,bM=function(){bk(bN,"/photo_search.php");};if(!this.pageState.id){var bL="http://"+this.parsedUri.hostname+this.parsedUri.pathname,bK=new bh(),bJ=function(bP){var bR=(bP.responseText||bP.payload.responseText),bQ=bR.match(/PROFILE_OWNER_ID\s?=\s?"(\d+)"/);bQ=bQ||bR.match(/profile=1&amp;id=(\d+)/);if(bQ){bN.pageState.id=bQ[1];bM();}else{bN.parseComplete();}};if(this.parsedUri.hostname===bK.hostname&&this.parsedUri.pathname===bK.pathname){this.pageState.id=window.PROFILE_OWNER_ID;bM();}else{R(this.parsedUri.pathname,{},bJ,function(bP){bN.asyncResponseError(bP);},this);}}else{bM();}};aW.prototype.parseResponse=function(bJ){this.parseResponseWithContinuation(new K(this,bJ));};aW.prototype.isSessionOk=function(bJ){return !(bJ.error===1357001);};function v(bJ){this.initialize();this.logo=am;this.title=aM;this.feedData=I;this.parsedUri=bJ;this.rangeBounds=new i(0,1);this.uri=bJ.toString();}v.prototype=new V();v.prototype.makeAsyncRequest=function(bK){var bJ=this;R("/profile.php",this.parsedUri.queryParameters,function(bL){bJ.asyncResponse(bL);},function(bL){bJ.asyncResponseError(bL);},this);};v.prototype.parseResponse=function(bJ){try{var bM=bJ.htmlDocument||U(bJ.getPayload().responseText),bK=J(bM,"profile_pic").src;item={guid:{$t:this.parsedUri.queryParameters.id},link:[{$t:this.uri},E],type:{$t:"profile"},name:{$t:J(bM,"profile_name").innerHTML},media$thumbnail:{url:bK},profilestatus:{$xml:bs(bB(J(bM,"profile_status"),Y,ax))},basicinfo:{$xml:bs(bB(J(bM,"basic_info_summary_box"),Y,ax))},profileactions:{$xml:bs(bB(bg(bM,"profile_actions","div")[0],Y,ax))},atom$source:a3()};this.addItem(P(item));this.parseComplete();}catch(bL){this.noResultsLoaded();}};v.prototype.isSessionOk=function(bJ){var bL=bJ.getPayload(),bK;if(bL.responseText){bK=U(bL.responseText);bJ.htmlDocument=bK;return !J(bK,"loginform");}else{return !(bJ.error===1357001);}return true;};function bm(){return this;}bm.prototype=new Q();bm.prototype.initialize=function(){M(this,"initialize");this.parseContentFromDOM();this.register();return this;};bm.prototype.feedForPage=function(bJ){this.feedUriForUri(bJ);switch(bJ.pathname){case"/album.php":case"/photo.php":return new N(bJ);case"/photos/":return new bA(bJ);case"/profile.php":return new v(bJ);case"/photo_search.php":return new aW(bJ);case"/home.php":return new bA(bJ);case"/":if(this.elements.length){bJ.pathname="/home.php";return new bA(bJ);}else{return null;}default:if(!bJ.pathname.match(/\/.+?(\.php$|\/)/)){return new aW(bJ);}else{return null;}}};bm.prototype.feedUriForUri=function(bJ){switch(bJ.pathname){case"/album.php":case"/photo.php":case"/photos/":case"/home.php":case"/photo_search.php":return bJ;default:if(bJ.pathname==="/profile.php"||!bJ.pathname.match(/\/.+?(\.php$|\/)/)){if(!a8||(bJ.queryParameters.v=="photos")){bJ.queryParameters.page=Math.floor((bJ.queryParameters.so||0)/20)+1;delete bJ.queryParameters.so;if(bJ.pathname==="/profile.php"){bJ.pathname="/photo_search.php";}}return bJ;}}return;};bm.prototype.hasFeedForPage=function(bJ){return this.feedUriForUri(bJ);};bm.prototype.feedForUrl=function(bJ){return this.feedForPage(new bh(bJ));};bm.prototype.parseContentFromDOM=function(){this.lastScan=(new Date).getTime();var bJ=[],bO=document.getElementsByTagName("A"),bX=0,bR,bK;while(bR=bO[bX++]){try{bK=aY(bR,"href");if(!bK||bK=="#"){continue;}if(bR.id&&bR.id.match(/icon_garden/)){continue;}var bN=this.feedUriForUri(new bh(bR.href));if(bN){var bV=bN.toString();var bS=bR.getElementsByTagName("IMG"),bM=bR.getElementsByTagName("I");if(bS[0]&&!bS[0].className.match(/(spritemap_.*icons|fb_logo_img)/)){if(bR.id=="myphotolink"){bN.queryParameters.pid=bD(bS[0].src);bN.queryParameters.id=aI(bS[0].src);bN.implodeQueryString();bV=bN.toString();}var bQ={element:bS[0],feedUri:bV,id:bN.canonicalID()};if(~bS[0].className.indexOf("UIRoundedImage_Image")&&bS[1]){bQ.element=bS[1];bQ.iconRect=t(bS[0],bS[1]);}bJ.push(bQ);}else{if(bR.parentNode.style.backgroundImage){var bW=bg(bR,"UIMediaItem_PhotoFrame","DIV")[0],bQ={element:bW||bR,feedUri:bV,id:bN.canonicalID()};bQ.iconRect=t(bR,bW||bR);bJ.push(bQ);}else{if(bM&&bM[0]&&bM[0].style.backgroundImage){bQ={element:bM[0],feedUri:bV,id:bN.canonicalID()};bQ.iconRect=t(bR,bW||bR);bJ.push(bQ);}}}}else{var bP=/http:\/\/www\.flickr\.com\/photos\/([^\/]+\/)([^\/]+\/)/,bL=bK.match(bP),bU=bR.getElementsByTagName("IMG");if(bL&&bU){bQ={element:bU[0],feedUri:"jsfeed:http://www.flickr.com/photos/"+bL[1]+"with/"+bL[2],id:bL[0]};bJ.push(bQ);}}}catch(bT){}}this.elements=bJ;return this;};bm.prototype.spawnReScanWatchDog=function(){if(this.watchDogSpawned){return;}var bL=this,bN,bJ=document.createElement("DIV"),bK=function(){if(bL.lastScan<bN){bL.initialize();}else{}document.body.removeChild(bJ);},bM=function(){bN=(new Date).getTime();document.body.appendChild(bJ);ac(bK,1200);};bJ.style.display="none";this.watchDogSpawned=true;H(bM,15000);};var bf=new bm();bf.initialize();bf.register();})();